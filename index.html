<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ægirson Holding AB — Family Holding Company</title>
    <style>
        body {
            background: #000;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            font-size: 15px;
            margin: 0;
            padding: 18px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            -webkit-font-smoothing: antialiased;
            -webkit-text-size-adjust: 100%;
        }
        #terminal {
            width: 100%;
            max-width: 900px;
            height: auto;
            max-height: calc(100vh - 120px);
            border: 1px solid rgba(0,255,0,0.12);
            padding: 16px 18px;
            box-sizing: border-box;
            overflow-y: auto;
            white-space: pre-wrap;
            line-height: 1.45;
            position: relative;
            border-radius: 10px;
            background: rgba(0,0,0,0.88);
            box-shadow: 0 8px 30px rgba(0,0,0,0.6);
        }
        #terminal::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(0, 255, 0, 0.03) 2px,
                rgba(0, 255, 0, 0.03) 4px
            );
            pointer-events: none;
        }
        .blink {
            animation: blink 1s infinite;
        }
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        .prompt {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }
        #input {
            background: transparent;
            border: none;
            color: #00ff00;
            font-family: inherit;
            font-size: 16px; /* ensure 16px to avoid mobile zoom */
            outline: none;
            flex: 1 1 120px;
            min-width: 0; /* allow input to shrink on small screens */
        }
        .hidden {
            visibility: hidden;
        }

        .controls { margin-top: 12px; display:flex; gap:8px; }
        .terminal-btn{
            background: transparent;
            color: #00ff00;
            border: 1px solid #00ff00;
            padding: 6px 10px;
            font-family: inherit;
            font-size: 14px;
            border-radius: 4px;
            cursor: pointer;
        }
        .terminal-btn:active{ background: rgba(0,255,0,0.05) }

        /* Responsive tweaks */
        @media (max-width: 720px) {
            body { padding: 12px; }
            #terminal { padding: 12px; max-width: 100%; max-height: calc(100vh - 100px); }
            #terminal::before { background-size: 100% 4px; }
            #output, #terminal { font-size: 14px; }
            #input { font-size: 16px; }
            .prompt span { font-size: 14px; }
        }
        @media (min-width: 721px) and (max-width: 1100px) {
            body { padding: 16px; }
            #terminal { max-width: 720px; }
        }
    </style>
</head>
<body>
    <div id="terminal">
        <div id="output"></div>
        <div class="prompt" id="prompt">
            <span>aegirson@family:~$ </span>
            <input type="text" id="input" autofocus>
            <span class="blink" id="cursor">█</span>
        </div>
        <div id="controls" class="controls hidden">
            <button id="playBtn" class="terminal-btn" aria-pressed="false">[PLAY A GAME]</button>
        </div>
    </div>

    <script>
        const output = document.getElementById('output');
        const input = document.getElementById('input');
        const cursor = document.getElementById('cursor');
        const prompt = document.getElementById('prompt');

        const bootMessages = [
            'Booting Ægirson Holding AB — Corporate Portal v1.0...',
            '[ OK ] Corporate registry verified.',
            '[ OK ] Loading business units: Investments, Operations, Compliance.',
            '',
            'Welcome to Ægirson Holding AB — Our family\'s Holding Company',
            '',
            'Corporate Information:',
            '  Company: Ægirson Holding AB',
            '  Registered Office: Stockholm, Sweden',
            '  Focus: Long-term value and stewardship',
            '',
            'Type "help" for commands (e.g. portfolio, contacts), or explore our holdings.',
            ''
        ];

        let messageIndex = 0;
        let charIndex = 0;
        // Game state
        let gameActive = false;
        let gameState = {
            inventory: [],
            safeOpened: false
        };

        const playBtn = document.createElement('div');

        function typeMessage() {
            if (messageIndex < bootMessages.length) {
                const message = bootMessages[messageIndex];
                if (charIndex < message.length) {
                    output.textContent += message[charIndex];
                    charIndex++;
                    // faster, tighter typing for snappier load
                    setTimeout(typeMessage, 6 + Math.random() * 10);
                } else {
                    output.textContent += '\n';
                    charIndex = 0;
                    messageIndex++;
                    // shorter pause between messages
                    setTimeout(typeMessage, 120);
                }
            } else {
                // Show prompt
                prompt.classList.remove('hidden');
                // Reveal play button/controls
                const controls = document.getElementById('controls');
                if (controls) controls.classList.remove('hidden');
                input.focus();
                cursor.style.display = 'inline';
            }
        }

        // Handle input
        input.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                const command = input.value;
                output.textContent += `aegirson@family:~$ ${command}\n`;
                const cmdLower = command.trim().toLowerCase();
                // secret command: open secret game page
                if (!gameActive && cmdLower.includes('secret game')) {
                    // navigate to secret.html in the same tab
                    location.href = 'secret.html';
                    return;
                }

                if (gameActive) {
                    handleGameCommand(command.trim());
                } else {
                    if (cmdLower === 'help') {
                        output.textContent += '  Available: ls (family photos), cat stories.txt, echo "love".\n';
                    } else if (cmdLower === 'clear') {
                        output.textContent = '';
                    } else {
                        output.textContent += `  Echo: ${command} executed with family flair.\n`;
                    }
                }
                input.value = '';
                output.scrollTop = output.scrollHeight;
            }
        });

        // Play button handler
        const btn = document.getElementById('playBtn');
        if (btn) {
            // Open the full game in the same tab
            btn.addEventListener('click', function(){
                location.href = 'game.html';
            });
        }

        function appendOutput(text) {
            output.textContent += text + '\n';
            output.scrollTop = output.scrollHeight;
        }

        function startGame(){
            gameActive = true;
            gameState = { inventory: [], safeOpened: false };
            appendOutput('=== Ægirson Holdings: Mini Text Game ===');
            appendOutput('You enter the secure office. There is a desk, a painting, and a small safe.');
            appendOutput('Type "help" for game commands. Type "quit" or "exit" to leave the game.');
            // focus input
            input.focus();
            // update button state
            const c = document.getElementById('playBtn'); if (c) c.setAttribute('aria-pressed','true');
            // hide the play button while game is active
            const controls = document.getElementById('controls'); if (controls) controls.classList.add('hidden');
        }

        function handleGameCommand(cmd){
            const c = cmd.toLowerCase();
            if (!c) return;
            if (c === 'help'){
                appendOutput('Game commands: look, open safe, take docs, inventory, quit');
                return;
            }
            if (c === 'look'){
                appendOutput('You see a tidy desk with a folder, a painting on the wall, and a small locked safe.');
                return;
            }
            if (c === 'open safe' || c === 'open the safe'){
                if (gameState.safeOpened){ appendOutput('The safe is already open. Inside: a deed and a keycard.'); }
                else { appendOutput('The safe is locked. You need a code. Maybe the painting hides a clue.'); }
                return;
            }
            if (c === 'take docs' || c === 'take deed' || c === 'take the deed'){
                if (!gameState.safeOpened){ appendOutput('You can\'t reach the deed; it is inside the locked safe.'); }
                else {
                    if (!gameState.inventory.includes('deed')){ gameState.inventory.push('deed'); appendOutput('You take the deed and put it in your portfolio.'); }
                    else appendOutput('You already took the deed.');
                }
                return;
            }
            if (c === 'inventory'){
                if (gameState.inventory.length === 0) appendOutput('You are carrying nothing.');
                else appendOutput('Inventory: ' + gameState.inventory.join(', '));
                return;
            }
            if (c === 'inspect painting' || c === 'painting'){
                appendOutput('You inspect the painting and find a small sticky note with the code "0420".');
                appendOutput('Try: open safe 0420');
                return;
            }
            if (c.startsWith('open safe ')){
                const parts = c.split(' ');
                const code = parts[2] || '';
                if (code === '0420'){ gameState.safeOpened = true; appendOutput('Safe unlocked. Inside: a deed and a keycard.'); }
                else appendOutput('Incorrect code.');
                return;
            }
            if (c === 'quit' || c === 'exit'){
                appendOutput('Exiting game...');
                gameActive = false;
                const cb = document.getElementById('playBtn'); if (cb) cb.setAttribute('aria-pressed','false');
                // reveal the play button again
                const controls = document.getElementById('controls'); if (controls) controls.classList.remove('hidden');
                return;
            }
            appendOutput('Unknown game command. Type "help" for commands.');
        }

        // Start boot sequence
        setTimeout(typeMessage, 500);

        // Blink cursor
        setInterval(() => {
            if (!prompt.classList.contains('hidden')) {
                cursor.style.opacity = cursor.style.opacity === '0' ? '1' : '0';
            }
        }, 500);
    </script>
</body>
</html>
